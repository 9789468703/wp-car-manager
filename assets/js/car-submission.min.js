Dropzone.autoDiscover=!1,jQuery(function(a){var b=!1;a.fn.wpcm_disable=function(){return b=!0,this.find("#wpcm-submit").attr("disabled","disabled").addClass("wpcm-disabled"),this},a.fn.wpcm_enable=function(){return b=!1,this.find("#wpcm-submit").removeAttr("disabled").removeClass("wpcm-disabled"),this},a.fn.wpcm_check_required=function(){var b=!0;return this.find(".wpcm-error").removeClass("wpcm-error"),a.each(this.find(".wpcm-required-field input, .wpcm-required-field textarea, .wpcm-required-field select"),function(c,d){(""==a(d).val()||0==a(d).val())&&(a(d).addClass("wpcm-error"),b=!1)}),b};var c=a("#wpcm-car-form");a("div#wpcm-car-submission-images").dropzone({url:wpcm.ajax_url_post_images,paramName:"wpcm_images",autoProcessQueue:!1,addRemoveLinks:!0,uploadMultiple:!0,parallelUploads:20,maxFiles:20,acceptedFiles:"image/*",init:function(){var a=this;c.on("wpcm_car_saved",function(b,c){a.options.url=wpcm.ajax_url_post_images+"&vehicle="+c.vehicle,a.processQueue()}),this.on("queuecomplete",function(){console.log("queuecomplete triggerd"),c.wpcm_enable()})}}),c.submit(function(){if(c.wpcm_disable(),!c.wpcm_check_required())return c.wpcm_enable(),!1;var d={nonce:wpcm.nonce_save,vehicle_id:c.data("vehicle"),data:c.serialize()};return jQuery.post(wpcm.ajax_url_save,d,function(d){if(d.success)c.trigger("wpcm_car_saved",[d]);else{if(d.errors.length>0)for(var e=0;e<d.errors.length;e++){var f=a("#"+d.errors[e].id);a(f).addClass("wpcm-error"),a(f).parent().append(a("<span>").addClass("wpcm-error-desc").html(d.errors[e].msg))}b=!1}console.log(d)}),!1})});